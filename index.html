
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>HGeSM - ConvÃªnios</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f8f9fa; }
    .logo { max-height: 120px; margin: 20px auto 10px; display: block; }
    h2.title { text-align: center; margin-bottom: 20px; }
    .grupo h4 {
      background: #007bff;
      color: white;
      padding: 10px;
      border-radius: 6px;
      margin-top: 30px;
    }
    table {
      width: 100%;
      margin-bottom: 20px;
    }
    th, td {
      padding: 8px;
      vertical-align: top;
    }
    .telefone a {
      color: #dc3545;
      text-decoration: none;
    }
    .search-box {
      margin-bottom: 25px;
    }
    @media (max-width: 768px) {
      td, th {
        display: block;
        width: 100%;
      }
    }
  </style>
</head>
<body>
<div class="container">
  <img src="HGeSM.png" alt="Logo HGeSM" class="logo">
  <h2 class="title">ðŸ“Œ ConvÃªnios HGeSM</h2>
  <input id="search" class="form-control search-box" type="text" placeholder="ðŸ” Pesquise por exame, clÃ­nica, endereÃ§o...">
  <div id="lista"></div>
</div>

<script>
const url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQiLAhk5UOYqyWcABYui1vxCAlTlDMbkJ5c-o3wl03A73Vy9HcKV9w7p8EsOtPMU1RKBA1tF_arWD88/pub?output=csv';

fetch(url)
  .then(response => response.text())
  .then(csv => {
    const linhas = csv.trim().split(/\r?\n/).map(l => l.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/));
    linhas.shift();
    const data = linhas.map(l => ({
      especialidade: l[0]?.replace(/"/g, ''),
      clinica: l[1]?.replace(/"/g, ''),
      endereco: l[2]?.replace(/"/g, ''),
      contato: l[3]?.replace(/"/g, '')
    }));
    render(data);
  })
  .catch(() => {
    document.getElementById('lista').innerHTML = '<p class="text-danger">Erro ao carregar os dados.</p>';
  });

function render(data) {
  const container = document.getElementById('lista');
  container.innerHTML = '';

  const grupos = {};
  data.forEach(item => {
    if (!item.especialidade) return;
    if (!grupos[item.especialidade]) grupos[item.especialidade] = [];
    grupos[item.especialidade].push(item);
  });

  Object.keys(grupos).sort().forEach(esp => {
    const divGrupo = document.createElement('div');
    divGrupo.className = 'grupo';
    divGrupo.innerHTML = `<h4>ðŸ©º ${esp}</h4>`;

    let tabela = `
      <table class="table table-striped table-bordered">
        <thead>
          <tr>
            <th>ClÃ­nica</th>
            <th>EndereÃ§o</th>
            <th>Contato</th>
          </tr>
        </thead>
        <tbody>
    `;

    grupos[esp].forEach(item => {
      const telefone = item.contato ? `<a href='https://wa.me/55${item.contato.replace(/\D/g,'')}' target='_blank'>ðŸ“ž ${item.contato}</a>` : '';
      tabela += `
        <tr>
          <td>${item.clinica}</td>
          <td>${item.endereco}</td>
          <td class="telefone">${telefone}</td>
        </tr>`;
    });

    tabela += '</tbody></table>';
    divGrupo.innerHTML += tabela;
    container.appendChild(divGrupo);
  });

  document.getElementById('search').addEventListener('keyup', function() {
    const q = this.value.toLowerCase();
    container.querySelectorAll('.grupo').forEach(grupo => {
      grupo.style.display = grupo.innerText.toLowerCase().includes(q) ? '' : 'none';
    });
  });
}
</script>
</body>
</html>
